# Day 23: åŠ¨æ€è§„åˆ’ - å­åºåˆ—é—®é¢˜ (Subsequence)

**æ—¥æœŸ**: 2026-01-07
**ä¸»é¢˜**: å­æ•°ç»„ vs å­åºåˆ—ã€äºŒç»´ DP å­—ç¬¦ä¸²åŒ¹é…
**æ ‡ç­¾**: #DynamicProgramming #String

## ğŸ§  æ ¸å¿ƒæ¦‚å¿µåŒºåˆ†

åœ¨ DP é—®é¢˜ä¸­ï¼Œè¾¨æ **è¿ç»­æ€§** è‡³å…³é‡è¦ï¼š

1.  **å­åºåˆ— (Subsequence)**:
    *   **ä¸è¦æ±‚è¿ç»­**ã€‚ä¾‹å¦‚ `[1, 3, 5]` æ˜¯ `[1, 2, 3, 4, 5]` çš„å­åºåˆ—ã€‚
    *   **çŠ¶æ€å®šä¹‰**ï¼šé€šå¸¸éœ€è¦ $O(N^2)$ æˆ–äºŒç»´ DPï¼Œå› ä¸ºéœ€è¦â€œå›å¤´çœ‹â€ä¹‹å‰çš„çŠ¶æ€ã€‚
2.  **å­æ•°ç»„/å­ä¸² (Subarray/Substring)**:
    *   **å¿…é¡»è¿ç»­**ã€‚ä¾‹å¦‚ `[1, 2]` æ˜¯ï¼Œä½† `[1, 3]` ä¸æ˜¯ã€‚
    *   **çŠ¶æ€å®šä¹‰**ï¼šé€šå¸¸åªéœ€è¦ $O(N)$ï¼Œå› ä¸ºçŠ¶æ€åªèƒ½ç”± `i-1` æ¨å¯¼è€Œæ¥ï¼Œä¸€æ—¦æ–­å¼€å°±é‡ç½®ã€‚

---

## é¢˜ç›®ä¸€ï¼š300. æœ€é•¿é€’å¢å­åºåˆ— (LIS)
**éš¾åº¦**: Medium
**ç±»å‹**: **å­åºåˆ— (ä¸è¿ç»­)**

### ğŸ’¡ æ ¸å¿ƒæ€è·¯
ä¸èƒ½ç®€å•å®šä¹‰ä¸ºâ€œå‰ i ä¸ªå…ƒç´ çš„æœ€é•¿é•¿åº¦â€ï¼Œå¿…é¡»å®šä¹‰ä¸º **â€œä»¥ nums[i] ç»“å°¾â€** çš„æœ€é•¿é•¿åº¦ã€‚
è¿™æ ·æ‰èƒ½ä¿è¯é€’å¢å…³ç³»çš„åˆ¤æ–­ï¼ˆåªæœ‰çŸ¥é“ç»“å°¾æ˜¯è°ï¼Œæ‰èƒ½çŸ¥é“èƒ½ä¸èƒ½æ¥åœ¨åé¢ï¼‰ã€‚

### ğŸ”¢ çŠ¶æ€è½¬ç§»
1.  **å®šä¹‰**ï¼š`dp[i]` è¡¨ç¤ºè‹¥ä»¥ `nums[i]` ä¸ºç»“å°¾çš„`nums`çš„æœ€é•¿é€’å¢å­åºåˆ—çš„é•¿åº¦ã€‚
2.  **çŠ¶æ€è½¬ç§»å…¬å¼**ï¼š
    éå† `i` ä¹‹å‰çš„æ‰€æœ‰ `j`ï¼Œå¦‚æœnums[i] > nums[j],é‚£ä¹ˆå°±å¯ä»¥æŠŠnums[i] åŠ åˆ°å·²ç»ç®—å¥½çš„å¦‚æœä»¥nums[j]ä¸ºç»“å°¾çš„æœ€é•¿ä¸¥æ ¼é€’å¢å­åºåˆ—çš„åé¢ï¼Œè¿™æ ·å°±å¯èƒ½æ„æˆæ›´é•¿çš„å­åºåˆ—ï¼š
    $$\text{if } nums[i] > nums[j]: \quad dp[i] = \max(dp[i], dp[j] + 1)$$
3.  **åˆå§‹åŒ–**ï¼š`dp` å…¨ä¸º 1ï¼ˆæ¯ä¸ªå…ƒç´ è‡ªèº«å°±æ˜¯é•¿åº¦ 1ï¼‰ã€‚
4.  **ç»“æœ**ï¼šå–dpæ•°ç»„æ‰€æœ‰å…ƒç´ çš„æœ€å¤§å€¼ï¼š`max(dp)`ã€‚

### ğŸ’» å…³é”®ä»£ç 
```python
class Solution:
    def lengthOfLIS(self, nums: List[int]) -> int:
        dp = [1] * len(nums)
        for i in range(1, len(nums)):
            for j in range(i):
                if nums[i] > nums[j]:
                    dp[i] = max(dp[i], dp[j] + 1)
        return max(dp)
```
*(å¤æ‚åº¦: Time $O(N^2)$, Space $O(N)$)*

### è´ªå¿ƒ + äºŒåˆ†æŸ¥æ‰¾
**æ—¶é—´å¤æ‚åº¦ä¸ºO(nlogn),ç©ºé—´å¤æ‚åº¦ä¸ºO(n)**

### ğŸ’¡æ ¸å¿ƒæ€è·¯

æˆ‘ä»¬éœ€è¦ç»´æŠ¤ä¸€ä¸ªæ•°ç»„ `tails`ï¼Œå…¶ä¸­ `tails[i]` ä»£è¡¨é•¿åº¦ä¸º i+1 çš„æ‰€æœ‰ä¸¥æ ¼ä¸Šå‡å­åºåˆ—ä¸­ï¼Œç»“å°¾æœ€å°çš„é‚£ä¸ªæ•°ã€‚
ä¸ºä»€ä¹ˆç»“å°¾è¶Šå°è¶Šå¥½ï¼Ÿ
å› ä¸ºç»“å°¾è¶Šå°ï¼Œåé¢æ¥ä¸Šä¸€ä¸ªæ›´å¤§çš„æ•°çš„å¯èƒ½æ€§å°±è¶Šå¤§ï¼ˆé—¨æ§›æ›´ä½ï¼‰ã€‚

éå† `nums` ä¸­çš„æ¯ä¸ªæ•° `num`ï¼šå¦‚æœ `num` æ¯” `tails` çš„æœ€åä¸€ä¸ªå…ƒç´ è¿˜å¤§ï¼š
è¯´æ˜å¯ä»¥ç›´æ¥æ¥åœ¨æœ€é•¿å­åºåˆ—åé¢å½¢æˆæ–°çš„æ›´é•¿çš„ä¸¥æ ¼é€’å¢å­åºåˆ—ï¼Œç›´æ¥æŠŠ num è¿½åŠ åˆ° tails æœ«å°¾ã€‚
å¦‚æœ `num` å°äºæˆ–ç­‰äº `tails` çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼š
æˆ‘ä»¬éœ€è¦åœ¨ `tails` ä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äº `num` çš„å…ƒç´ ï¼Œå¹¶ç”¨ `num` æ›¿æ¢å®ƒã€‚
**è¿™ä¸€æ­¥çš„æ„ä¹‰ï¼šæˆ‘ä»¬ç”¨ä¸€ä¸ªæ›´å°çš„æ•°æ›¿æ¢äº†åŸæ¥çš„ç»“å°¾ï¼Œè™½ç„¶åºåˆ—é•¿åº¦æ²¡å˜ï¼Œä½†è®©è¿™ä¸ªåºåˆ—çš„â€œå¢é•¿æ½œåŠ›â€å˜å¤§äº†ï¼ˆå˜å¾—æ›´å¹³ç¼“äº†ï¼‰ã€‚
æŸ¥æ‰¾è¿‡ç¨‹æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ äºŒåˆ†æŸ¥æ‰¾**

### ğŸ’» å…³é”®ä»£ç 
æ ‡å‡†äºŒåˆ†æŸ¥æ‰¾ä»£ç (å¿…èƒŒ)*è¿­ä»£ç‰ˆæœ¬*
```python
def binary_search(nums: List[int],target: int) -> int:
    if not nums:
        return -1

    n = len(nums)
    left,right = 0,n - 1
    while left <= right:
        mid = left + (right - left) // 2 # é˜²æ­¢æ•´å‹æº¢å‡ºï¼Œpythonä¸ä¼šï¼Œä½†javaï¼Œcæ˜¯å¥½çš„å†™æ³•
        if nums[mid] == target:
            return mid
        elif nums[mid] < target:
            left = mid +1
        else:
            right = mid - 1
    return -1
``` 

**æ‰‹åŠ¨ç¼–å†™äºŒåˆ†æŸ¥æ‰¾**å®ç°æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äº`target`çš„`nums`æ•°ç»„çš„ç´¢å¼•
```python
def binary_search_left(nums: List[int],target: int) -> int:
    left,right = 0,len(nums) # rightåˆå§‹åŒ–ä¸ºlen(nums),è€Œä¸æ˜¯len(nums)-1,æ˜¯å› ä¸ºå¦‚æœtargetæ¯”æ‰€æœ‰æ•°éƒ½å¤§ï¼Œåˆ™å‡½æ•°éœ€è¦è¿”å›len(nums),å³æ•°ç»„æœ€åä¸€ä¸ªä¸‹æ ‡+1ï¼Œè‹¥rightåˆå§‹åŒ–ä¸ºlen(nums)-1,åˆ™æ°¸è¿œä¸ä¼šè¿”å›len(nums)
    while left < right: # å·¦é—­å³å¼€å¾ªåŒºé—´ï¼Œè¿­ä»£ç»ˆæ­¢æ¡ä»¶ä¸ºleft == right,æ­¤æ—¶leftå’Œrightå°±æ˜¯è¿”å›å€¼
        mid = left + (right - left) // 2
        if nums[mid] < target: # è‹¥ä¸­é—´å€¼å°äºtagetï¼Œåˆ™ç”±äºæˆ‘ä»¬è¦æ‰¾çš„æ˜¯æ¯”å¤§äºç­‰äºtargetçš„ç¬¬ä¸€ä¸ªå€¼ï¼Œæ‰€ä»¥ä¸€å®šåœ¨å³è¾¹
            left = mid +1
        else: # è‹¥ä¸­é—´å€¼ç­‰äºtarget,åˆ™è¯´æ˜ç›®æ ‡å€¼æ˜¯mid,æˆ–midå·¦ä¾§ä½†ä¸ç¡®å®šï¼›è‹¥ä¸­é—´å€¼å¤§äºtargetï¼Œåˆ™ä¹Ÿè¯´æ˜ç›®æ ‡å€¼åœ¨åŒ…æ‹¬midçš„å·¦ä¾§ï¼Œè‹¥ä¾righrä¸èƒ½ - 1
            right = mid
    
    retun left
```

**è´ªå¿ƒ+äºŒåˆ†æŸ¥æ‰¾**ï¼ˆ*ç”¨pythonå†…ç½®å‡½æ•°bisect_leftæŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äºç­‰äºnumçš„å°æ ‡*ï¼‰ï¼Œ
```python
import bisect
class Solution():
    def lengthOfLIS(self,nums: List[int]) -> int:
        if not nums:
            return 0
        n = len(nums)

        tails = []
        for num in nums:
            if not tails or num > tails[-1]:
                tails.append(num)
            else:
                idx = bisect.bisect_left(tails,num)
                tails[idx] = num

        return len(tails)
```

---

## é¢˜ç›®äºŒï¼š674. æœ€é•¿è¿ç»­é€’å¢åºåˆ—
**éš¾åº¦**: Easy
**ç±»å‹**: **å­æ•°ç»„ (è¿ç»­)**

### ğŸ’¡ æ ¸å¿ƒæ€è·¯
å› ä¸ºè¦æ±‚ **è¿ç»­**ï¼Œ`nums[i]` åªéœ€è¦è·Ÿç´§æŒ¨ç€çš„ `nums[i-1]` æ¯”ã€‚ä¸éœ€è¦ä¸¤å±‚å¾ªç¯ã€‚

### ğŸ”¢ çŠ¶æ€è½¬ç§»
1.  **é€’æ¨**ï¼š
    *   å¦‚æœ `nums[i] > nums[i-1]`ï¼š`dp[i] = dp[i-1] + 1`
    *   å¦åˆ™ï¼ˆæ–­äº†ï¼‰ï¼š`dp[i] = 1`
2.  **ç©ºé—´ä¼˜åŒ–**ï¼šå…¶å®åªéœ€è¦ä¸€ä¸ªå˜é‡è®°å½•å½“å‰è¿ç»­é•¿åº¦å³å¯ï¼Œä¸éœ€è¦æ•°ç»„ã€‚

---

## é¢˜ç›®ä¸‰ï¼š1143. æœ€é•¿å…¬å…±å­åºåˆ— (LCS)
**éš¾åº¦**: Medium
**ç±»å‹**: **äºŒç»´ DP** (ä¸¤ä¸ªå­—ç¬¦ä¸²)

### ğŸ’¡ æ ¸å¿ƒæ€è·¯
æ¶‰åŠä¸¤ä¸ªå­—ç¬¦ä¸²çš„å­åºåˆ—é—®é¢˜ï¼Œæ ‡å‡†è§£æ³•æ˜¯å»ºç«‹ä¸€ä¸ª **äºŒç»´è¡¨æ ¼**ã€‚
è¡Œä»£è¡¨ `text1`ï¼Œåˆ—ä»£è¡¨ `text2`ã€‚

### ğŸ”¢ çŠ¶æ€è½¬ç§»æ–¹ç¨‹
**å®šä¹‰**ï¼š`dp[i][j]` è¡¨ç¤º `text1[0...i-1]` å’Œ `text2[0...j-1]` çš„ LCS é•¿åº¦ã€‚

**é”™ä½æŠ€å·§**ï¼šDP æ•°ç»„å¤§å°è®¾ä¸º `(L1+1) * (L2+1)`ï¼Œå…¶ä¸­ `dp[0][0]` ä»£è¡¨ç©ºä¸²å¯¹æ¯”ç©ºä¸²ã€‚è¿™æ ·å¯ä»¥é¿å…å¤„ç† `i-1` è¶Šç•Œé—®é¢˜ã€‚

**é€’æ¨é€»è¾‘**ï¼š
1.  **å­—ç¬¦ç›¸ç­‰** (`text1[i-1] == text2[j-1]`)ï¼š
    *   è¿™ä¸ªå­—ç¬¦ä¸€å®šåœ¨ LCS é‡Œã€‚
    *   ç»§æ‰¿å·¦ä¸Šè§’çš„ç»“æœ + 1ã€‚
    *   $$ dp[i][j] = dp[i-1][j-1] + 1 $$
2.  **å­—ç¬¦ä¸ç­‰**ï¼š
    *   ç»§æ‰¿å·¦è¾¹æˆ–è€…ä¸Šè¾¹çš„æœ€å¤§å€¼ï¼ˆç›¸å½“äºåˆ æ‰ text1 çš„å½“å‰å­—ç¬¦ï¼Œæˆ–è€…åˆ æ‰ text2 çš„å½“å‰å­—ç¬¦ï¼‰ã€‚
    *   $$ dp[i][j] = \max(dp[i-1][j], \quad dp[i][j-1]) $$

### ğŸ’» å…³é”®ä»£ç 
```python
class Solution:
    def longestCommonSubsequence(self, text1: str, text2: str) -> int:
        m, n = len(text1), len(text2)
        dp = [[0] * (n + 1) for _ in range(m + 1)]
        
        for i in range(1, m + 1):
            for j in range(1, n + 1):
                # æ³¨æ„ï¼šdpç´¢å¼•æ˜¯ i,jï¼Œå¯¹åº”å­—ç¬¦ä¸²ç´¢å¼•è¦å‡ 1
                if text1[i-1] == text2[j-1]:
                    dp[i][j] = dp[i-1][j-1] + 1
                else:
                    dp[i][j] = max(dp[i-1][j], dp[i][j-1])
                    
        return dp[m][n]
```

### ğŸš€ è¿›é˜¶ï¼šç©ºé—´ä¼˜åŒ– (æ»šåŠ¨æ•°ç»„)
ç”±äº `dp[i]` åªä¾èµ–äº `dp[i-1]` (ä¸Šä¸€è¡Œ)ï¼Œæˆ‘ä»¬å¯ä»¥åªç”¨ä¸¤è¡Œæ•°ç»„æ»šåŠ¨æ›´æ–°ã€‚
*   **Time**: $O(M \times N)$
*   **Space**: $O(\min(M, N))$

---

## ğŸ“Š æ€»ç»“å›¾è§£

| åœºæ™¯ | çŠ¶æ€å®šä¹‰ | é€’æ¨æ–¹å‘ | å¤æ‚åº¦ |
| :--- | :--- | :--- | :--- |
| **æœ€é•¿é€’å¢å­åºåˆ—** | ä¸€ç»´ `dp[i]` | å›å¤´çœ‹ `0...i-1` | $O(N^2)$ |
| **æœ€é•¿è¿ç»­é€’å¢** | ä¸€ç»´ `dp[i]` | åªçœ‹ `i-1` | $O(N)$ |
| **æœ€é•¿å…¬å…±å­åºåˆ—** | äºŒç»´ `dp[i][j]` | å·¦ä¸Šã€å·¦ã€ä¸Š | $O(N \times M)$ |
```