# Day 17: 0-1 èƒŒåŒ…é—®é¢˜è¿›é˜¶ (Knapsack Variations)

**æ—¥æœŸ**: 2025-12-31
**ä¸»é¢˜**: åŠ¨æ€è§„åˆ’ã€èƒŒåŒ…å˜ä½“ã€æ•°å­¦è½¬åŒ–
**æ ‡ç­¾**: #DynamicProgramming #Knapsack #Math

## ğŸ“ æ ¸å¿ƒæ€»ç»“
ä»Šå¤©æ”»å…‹äº† 0-1 èƒŒåŒ…çš„ä¸‰ç§å¸¸è§å˜ä½“ã€‚è™½ç„¶é¢˜ç›®èƒŒæ™¯å„å¼‚ï¼Œä½†æ ¸å¿ƒé€»è¾‘ä¾ç„¶éµå¾ªï¼š
1.  **å¤–å±‚å¾ªç¯**ï¼šéå†ç‰©å“ã€‚
2.  **å†…å±‚å¾ªç¯**ï¼šéå†èƒŒåŒ…å®¹é‡ï¼ˆå¿…é¡»**å€’åº**ï¼‰ã€‚
3.  **çŠ¶æ€è½¬ç§»**ï¼šæ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œé€‰æ‹© `max` (æ±‚æœ€å€¼) æˆ– `+=` (æ±‚æ–¹æ¡ˆæ•°)ã€‚

---

## é¢˜ç›®ä¸€ï¼š1049. æœ€åä¸€å—çŸ³å¤´çš„é‡é‡ II (Last Stone Weight II)
**éš¾åº¦**: Medium
**ç±»å‹**: æ±‚æœ€å°å‰©ä½™ / æœ€æ¥è¿‘ Target
**é“¾æ¥**: [LeetCode 1049](https://leetcode.cn/problems/last-stone-weight-ii/)

### ğŸ’¡ æ ¸å¿ƒæ€è·¯
è¿™é“é¢˜æœ¬è´¨ä¸Šæ˜¯å°†çŸ³å¤´åˆ†ä¸ºä¸¤å †ï¼Œè®©å®ƒä»¬çš„é‡é‡**å°½å¯èƒ½æ¥è¿‘**ã€‚
*   å¦‚æœä¸¤å †é‡é‡ç›¸ç­‰ï¼Œå·®å€¼ä¸º 0ï¼ˆç²‰ç¢ï¼‰ã€‚
*   å¦‚æœæ— æ³•å®Œå…¨ç›¸ç­‰ï¼Œå·®å€¼å°±æ˜¯æœ€åå‰©ä¸‹çš„çŸ³å¤´ã€‚
*   **è½¬åŒ–**ï¼šè¿™å®Œå…¨ç­‰ä»·äº **416. åˆ†å‰²ç­‰å’Œå­é›†**ã€‚
    *   èƒŒåŒ…å®¹é‡ `target = sum(stones) // 2`ã€‚
    *   æˆ‘ä»¬è¦æ‰¾å‡ºä¸€ç»„çŸ³å¤´ï¼Œè®©å®ƒä»¬çš„æ€»é‡**å°½å¯èƒ½æ¥è¿‘ï¼ˆä½†ä¸è¶…è¿‡ï¼‰** `target`ã€‚

### ğŸ”¢ ç®—æ³•æ­¥éª¤
1.  è®¡ç®—æ€»é‡ `total_sum`ï¼Œå¾—å‡º `target = total_sum // 2`ã€‚
2.  å®šä¹‰ `dp[j]`ï¼šå®¹é‡ä¸º `j` çš„èƒŒåŒ…æœ€å¤šèƒ½è£…å¤šå°‘é‡é‡ã€‚
3.  0-1 èƒŒåŒ…é€’æ¨ï¼š`dp[j] = max(dp[j], dp[j - stone] + stone)`ã€‚
4.  **æœ€ç»ˆç»“æœ**ï¼šä¸€å †çš„é‡é‡æ˜¯ `dp[target]`ï¼Œå¦ä¸€å †æ˜¯ `total_sum - dp[target]`ã€‚
    *   `result = (total_sum - dp[target]) - dp[target]`ã€‚

### ğŸ’» å…³é”®ä»£ç 
```python
class Solution:
    def lastStoneWeightII(self, stones: List[int]) -> int:
        total_sum = sum(stones)
        target = total_sum // 2
        dp = [0] * (target + 1)
        
        for stone in stones:
            for j in range(target, stone - 1, -1):
                dp[j] = max(dp[j], dp[j - stone] + stone)
                
        return (total_sum - dp[target]) - dp[target]
```

---

## é¢˜ç›®äºŒï¼š494. ç›®æ ‡å’Œ (Target Sum)
**éš¾åº¦**: Medium
**ç±»å‹**: **æ±‚æ–¹æ¡ˆæ•°** (Number of Ways)
**é“¾æ¥**: [LeetCode 494](https://leetcode.cn/problems/target-sum/)

### ğŸ’¡ æ ¸å¿ƒæ€è·¯ (æ•°å­¦é™ç»´)
ç›´æ¥å›æº¯ä¼šè¶…æ—¶ï¼Œéœ€è¦è½¬åŒ–ä¸ºèƒŒåŒ…é—®é¢˜ã€‚
å°†æ•°ç»„åˆ†ä¸º **æ­£æ•°å † (P)** å’Œ **è´Ÿæ•°å † (N)**ï¼š
1.  $P - N = \text{target}$
2.  $P + N = \text{sum}$
3.  ä¸¤å¼ç›¸åŠ  $\Rightarrow 2P = \text{target} + \text{sum} \Rightarrow P = (\text{target} + \text{sum}) / 2$

**è½¬åŒ–**ï¼šä»æ•°ç»„ä¸­é€‰å‡ºè‹¥å¹²ä¸ªæ•°ï¼Œä½¿å…¶å’Œæ°å¥½ä¸º `bag_size = (target + sum) // 2`ã€‚æ±‚æœ‰å¤šå°‘ç§é€‰æ³•ï¼Ÿ

### ğŸ”¢ çŠ¶æ€è½¬ç§»æ–¹ç¨‹
*   **å®šä¹‰**ï¼š`dp[j]` è¡¨ç¤ºå¡«æ»¡å®¹é‡ä¸º `j` çš„èƒŒåŒ…ï¼Œæœ‰ **`dp[j]` ç§æ–¹æ³•**ã€‚
*   **é€’æ¨**ï¼š
    *   ä¸æ”¾å½“å‰ç‰©å“ï¼šæ–¹æ³•æ•°ä¸º `dp[j]`ã€‚
    *   æ”¾å…¥å½“å‰ç‰©å“ï¼šæ–¹æ³•æ•°ä¸º `dp[j - num]`ã€‚
    *   **å…¬å¼**ï¼š$$ dp[j] += dp[j - num] $$
*   **åˆå§‹åŒ–**ï¼š`dp[0] = 1`ï¼ˆè£…æ»¡å®¹é‡ 0 åªæœ‰ä¸€ç§æ–¹æ³•ï¼šä»€ä¹ˆéƒ½ä¸è£…ï¼‰ã€‚

### ğŸ’» å…³é”®ä»£ç 
```python
class Solution:
    def findTargetSumWays(self, nums: List[int], target: int) -> int:
        total_sum = sum(nums)
        # è¾¹ç•Œæ¡ä»¶ï¼šç»å¯¹å€¼è¶…é™ æˆ– æ— æ³•æ•´é™¤2
        if abs(target) > total_sum or (target + total_sum) % 2 != 0:
            return 0
            
        bag_size = (target + total_sum) // 2
        dp = [0] * (bag_size + 1)
        dp[0] = 1 # æ ¸å¿ƒåˆå§‹åŒ–
        
        for num in nums:
            for j in range(bag_size, num - 1, -1):
                dp[j] += dp[j - num] # æ±‚æ–¹æ¡ˆæ•°ç”¨ç´¯åŠ 
                
        return dp[bag_size]
```

---

## é¢˜ç›®ä¸‰ï¼š474. ä¸€å’Œé›¶ (Ones and Zeroes)
**éš¾åº¦**: Medium
**ç±»å‹**: **äºŒç»´è´¹ç”¨**èƒŒåŒ… (2D Cost Knapsack)
**é“¾æ¥**: [LeetCode 474](https://leetcode.cn/problems/ones-and-zeroes/)

### ğŸ’¡ æ ¸å¿ƒæ€è·¯
è¿™ä¾ç„¶æ˜¯ 0-1 èƒŒåŒ…ï¼ˆæ¯ä¸ªå­—ç¬¦ä¸²åªèƒ½é€‰ä¸€æ¬¡ï¼‰ï¼Œä½†æ˜¯èƒŒåŒ…æœ‰ä¸¤ä¸ªç»´åº¦çš„é™åˆ¶ï¼š
1.  **é™åˆ¶ A**ï¼šæœ€å¤š `m` ä¸ª 0ã€‚
2.  **é™åˆ¶ B**ï¼šæœ€å¤š `n` ä¸ª 1ã€‚
æˆ‘ä»¬éœ€è¦åœ¨è¿™ä¸¤ä¸ªé™åˆ¶ä¸‹ï¼Œè£…å…¥å°½å¯èƒ½å¤šçš„â€œç‰©å“æ•°é‡â€ã€‚

### ğŸ”¢ ç®—æ³•æ­¥éª¤
1.  **å®šä¹‰**ï¼š`dp[i][j]` è¡¨ç¤ºåœ¨æœ€å¤š `i` ä¸ª 0 å’Œ `j` ä¸ª 1 çš„é™åˆ¶ä¸‹ï¼Œæœ€å¤šèƒ½è£…å¤šå°‘ä¸ªå­—ç¬¦ä¸²ã€‚
2.  **æ¶ˆè€—**ï¼šæ¯ä¸ªå­—ç¬¦ä¸²çš„ cost æ˜¯ `zeroNum` å’Œ `oneNum`ã€‚
3.  **ä»·å€¼**ï¼šæ¯ä¸ªå­—ç¬¦ä¸²çš„ value æ˜¯ 1ã€‚
4.  **éå†**ï¼š
    *   å¤–å±‚éå†å­—ç¬¦ä¸²ï¼ˆç‰©å“ï¼‰ã€‚
    *   å†…å±‚éå†ä¸¤ä¸ªç»´åº¦ `m` å’Œ `n`ã€‚
    *   **å…³é”®**ï¼šä¸¤ä¸ªç»´åº¦**éƒ½è¦å€’åº**ï¼é¡ºåºå¯ä»¥äº’æ¢ï¼Œä½†å¿…é¡»éƒ½æ˜¯ä»å¤§åˆ°å°ã€‚
5.  **å…¬å¼**ï¼š
    $$ dp[i][j] = \max(dp[i][j], \ dp[i - \text{zeros}][j - \text{ones}] + 1) $$

### ğŸ’» å…³é”®ä»£ç 
```python
class Solution:
    def findMaxForm(self, strs: List[str], m: int, n: int) -> int:
        dp = [[0] * (n + 1) for _ in range(m + 1)]
        
        for s in strs:
            zeros = s.count('0')
            ones = s.count('1')
            
            # ä¸¤ä¸ªç»´åº¦å…¨éƒ¨å€’åº
            for i in range(m, zeros - 1, -1):
                for j in range(n, ones - 1, -1):
                    dp[i][j] = max(dp[i][j], dp[i - zeros][j - ones] + 1)
                    
        return dp[m][n]
```

---

## ğŸ“Š å¤æ‚åº¦é€ŸæŸ¥è¡¨

| é¢˜ç›® | èƒŒåŒ…ç±»å‹ | é€’æ¨å…¬å¼ç¬¦å· | å¤æ‚åº¦ | å¤‡æ³¨ |
| :--- | :--- | :--- | :--- | :--- |
| **1049. æœ€åä¸€å—çŸ³å¤´** | æ±‚æœ€å¤§é‡é‡ | `max` | $O(N \times \text{Sum})$ | è½¬åŒ–ä¸º 416 |
| **494. ç›®æ ‡å’Œ** | **æ±‚æ–¹æ¡ˆæ•°** | **`+=`** | $O(N \times \text{Bag})$ | åˆå§‹åŒ– `dp[0]=1` |
| **474. ä¸€å’Œé›¶** | **äºŒç»´è´¹ç”¨** | `max` | $O(L \times m \times n)$ | åŒé‡å€’åºå¾ªç¯ |

*æ³¨ï¼šèƒŒåŒ…é—®é¢˜çš„å¤æ‚åº¦é€šå¸¸æ˜¯**ä¼ªå¤šé¡¹å¼æ—¶é—´**ï¼Œå–å†³äºèƒŒåŒ…å®¹é‡çš„å¤§å°ã€‚*