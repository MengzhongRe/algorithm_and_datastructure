# Day 19: 完全背包理论与实战 (Unbounded Knapsack)

**日期**: 2026-01-04
**主题**: 动态规划、完全背包、排列与组合
**标签**: #DynamicProgramming #Knapsack

## 🎒 理论核心：完全背包 vs 0-1 背包

### 1. 定义区别
*   **0-1 背包**：每件物品只能用 **1次**。
*   **完全背包**：每件物品可以用 **无限次**。

### 2. 代码实现区别 (遍历顺序)
唯一的区别在于 **内层循环的方向**。

*   **0-1 背包**：内层循环 **倒序** (从大到小)。
    *   *原因*：保证每个物品只被添加一次，防止利用本层刚更新的状态。
*   **完全背包**：内层循环 **正序** (从小到大)。
    *   *原因*：因为物品无限，我们需要利用“当前物品已经被放入过”的状态来继续添加同一个物品。

---

## ⚖️ 进阶难点：组合数 vs 排列数

在完全背包求方案数的问题中，**两层 for 循环的嵌套顺序** 决定了结果是组合还是排列。

### 1. 求组合数 (Combinations)
*   **定义**：不考虑顺序，`{1, 2}` 和 `{2, 1}` 视为同一种。
*   **遍历顺序**：**先遍历物品，再遍历背包**。
*   **原理**：先处理完物品1，再处理物品2。结果中物品2永远在1后面，顺序被锁死，消除了顺序差异。
*   **典型题目**：[518. 零钱兑换 II](https://leetcode.cn/problems/coin-change-ii/)

### 2. 求排列数 (Permutations)
*   **定义**：考虑顺序，`{1, 2}` 和 `{2, 1}` 视为两种。
*   **遍历顺序**：**先遍历背包，再遍历物品**。
*   **原理**：在容量为 `j` 时，重新扫描所有物品。这意味着可以在“先放了1”的基础上放2，也可以在“先放了2”的基础上放1。
*   **典型题目**：[377. 组合总和 Ⅳ](https://leetcode.cn/problems/combination-sum-iv/)

---

## 📝 题目复盘

### 题目一：518. 零钱兑换 II (组合数)
**思路**：
这是一道标准的完全背包求组合数问题。
```python
# 先物品，后背包
for coin in coins:
    for j in range(coin, amount + 1):
        dp[j] += dp[j - coin]
```

### 题目二：377. 组合总和 Ⅳ (排列数)
**思路**：
虽然题目叫“组合”，但描述中明确说“顺序不同的序列被视作不同的组合”，所以是求排列。
```python
# 先背包，后物品
for j in range(1, target + 1):
    for num in nums:
        if j >= num:
            dp[j] += dp[j - num]
```

### 题目三：139. 单词拆分 (Word Break)
**思路**：
这道题是完全背包在字符串上的应用。
*   **背包**：字符串 `s`。
*   **物品**：字典 `wordDict`。
*   **顺序**：字符串是有序的（"apple" + "pen" $\neq$ "pen" + "apple"），所以是 **排列数** 问题。

```python
# 先背包 (字符串长度)，后物品 (字典)
for i in range(1, len(s) + 1):
    for word in wordDict:
        length = len(word)
        # 1. 背包放得下
        # 2. 单词匹配
        # 3. 前面的部分能拼出来
        if i >= length and s[i-length:i] == word and dp[i-length]:
            dp[i] = True
            break
```

---

## 📊 总结速查表

| 问题类型 | 物品使用次数 | 内层循环方向 | 循环嵌套顺序 | 典型例题 |
| :--- | :--- | :--- | :--- | :--- |
| **0-1 背包** | 1 次 | **倒序** | 先物品，后背包 | 416. 分割等和子集 |
| **完全背包** | 无限次 | **正序** | (见下文) | 322. 零钱兑换 |
| **求组合数** | 无限次 | 正序 | **先物品，后背包** | 518. 零钱兑换 II |
| **求排列数** | 无限次 | 正序 | **先背包，后物品** | 377. 组合总和 Ⅳ |